<html>
  <head>
    <link type="text/css" rel="stylesheet" href="HeatMap.css">
    <script src="HeatMap.js"></script>
    <style>
      body { 
        font: 14px helvetica neue, helvetica, arial, sans-serif;
        background: #363838;;
      }
    </style>
  </head>
  <body>
    <div id="heatmap">
      <!--table id="heatmapTimeline">
        <tr id="heatmapTimeRow">
          <th class="heatmapFixTh heatmapTimeCell">
          <th><p class="heatmapTimeRowValue">1420
          <th><p class="heatmapTimeRowValue">1421
          <th><p class="heatmapTimeRowValue">1422
          <th><p class="heatmapTimeRowValue heatmapTimeCellSelected">1423
          <th><p class="heatmapTimeRowValue">1424
          <th><p class="heatmapTimeRowValue">1425</th>
        <tr id="heatmapNRow_Notes" class="heatmapRow">
          <td class="heatmapFixTh heatmapTimeNotes">Notes
            <td><div class="heatmapTimeNoteText" contenteditable>Start</div>
            <td><div class="heatmapTimeNoteText" contenteditable>&nbsp;</div>
            <td><div class="heatmapTimeNoteText" contenteditable>Check</div>
            <td><div class="heatmapTimeNoteText" contenteditable>&nbsp;</div>
            <td><div class="heatmapTimeNoteText" contenteditable>&nbsp;</div>
            <td><div class="heatmapTimeNoteText" contenteditable>&nbsp;</div>
        <tr id="heatmapSRow_Tom_loadingCheck" class="heatmapRow">
          <td class="heatmapSignalName">Tom.loadingCheck
            <td class="heatmamValueCell" style="background-color: rgb(207, 225, 143);">
            <td class="heatmamValueCell" style="background-color: rgb(154, 181, 154);">
            <td class="heatmamValueCell" style="background-color: rgb(144, 173, 181);">
            <td class="heatmamValueCell" style="background-color: rgb(207, 225, 143);">
            <td class="heatmamValueCell" style="background-color: rgb(154, 181, 154);">
            <td class="heatmamValueCell" style="background-color: rgb(144, 173, 181);">
        <tr id="heatmapSRow_Alex_loadingCheck" class="heatmapRow">
          <td class="heatmapSignalName">Alex.loadingCheck
            <td class="heatmamValueCell" style="background-color: rgb(199, 166, 166);">
            <td class="heatmamValueCell" style="background-color: rgb(236, 133, 133);">
            <td class="heatmamValueCell" style="background-color: rgb(151, 151, 183);">
            <td class="heatmamValueCell" style="background-color: rgb(207, 225, 143);">
            <td class="heatmamValueCell" style="background-color: rgb(154, 181, 154);">
            <td class="heatmamValueCell" style="background-color: rgb(144, 173, 181);">
        <tr id="heatmapSRow_Meisy_loadingCheck" class="heatmapRow">
          <td class="heatmapSignalName">Meisy.loadingCheck
            <td class="heatmamValueCell" style="background-color: rgb(223, 190, 147);">
            <td class="heatmamValueCell" style="background-color: rgb(220, 186, 235);">
            <td class="heatmamValueCell" style="background-color: rgb(176, 208, 165);">
            <td class="heatmamValueCell" style="background-color: rgb(223, 190, 147);">
            <td class="heatmamValueCell" style="background-color: rgb(220, 186, 235);">
            <td class="heatmamValueCell" style="background-color: rgb(176, 208, 165);">
        <tr id="heatmapSRow_Tom_loadingCheck" class="heatmapRow">
          <td class="heatmapSignalName">Tom.loadingCheck
            <td class="heatmamValueCell" style="background-color: rgb(207, 225, 143);">
            <td class="heatmamValueCell" style="background-color: rgb(154, 181, 154);">
            <td class="heatmamValueCell" style="background-color: rgb(144, 173, 181);">
            <td class="heatmamValueCell" style="background-color: rgb(199, 166, 166);">
            <td class="heatmamValueCell" style="background-color: rgb(236, 133, 133);">
            <td class="heatmamValueCell" style="background-color: rgb(151, 151, 183);">
      </table-->
    </div>
    <script>
      const hm = new HeatMap( 'heatmap' );
      { 
        const name = 'M1';
        hm.create( name );
        hm.setValueMap( name, {
          'ready': '#71A1C9',
          'running': '#8caa55',
          'suspended': '#eee957',
          'terminated': '#D57C7A'
        });
        hm.addEventListener( 'TimestepClick', (e,i,v)=> console.log( 'Click on timeInded '+i ));
        hm.addEventListener( 'SignalClick', (e,i,v)=> console.log( 'Click on signal '+v ));
        hm.addSignalList( name, [ 'Signal1 test', 'Signal2 prova', 'Signal3 probe', 'Signal4 new one' ] );
        const dataList = [
          [ 'running', 'ready', 'terminated', 'ready' ],
          [ 'running', 'suspended', 'terminated', 'running' ],
          [ 'running', 'ready', 'terminated', 'running' ],
          [ 'running', 'suspended', 'terminated', 'running' ],
          [ 'running', 'suspended', 'ready', 'running' ],
          [ 'running', 'suspended', 'terminated', 'running' ],
        ];
        for( const data of dataList ) {
          hm.addSignalValueList( name, null, null, data );
        }
        hm.setHighlightTimestep( 'M1', 2, true );
      }
      {
        const name = 'M2';
        hm.create( name, false );
        hm.setValueMap( name, {
          'ready': '#71A1C9',
          'running': '#8caa55',
          'suspended': '#eee957',
          'terminated': '#D57C7A'
        });
        hm.addSignalList( name, [ 'Signal1 test', 'Signal2 prova', 'Signal3 probe', 'Signal4 new one' ] );
        const dataList = [
          [ 'running', 'suspended', 'ready', 'running' ],
          [ 'running', 'suspended', 'terminated', 'running' ],
          [ 'running', 'ready', 'terminated', 'running' ],
          [ 'running', 'ready', 'terminated', 'ready' ],
          [ 'running', 'suspended', 'terminated', 'running' ],
          [ 'running', 'suspended', 'terminated', 'running' ],
        ];
        for( const data of dataList ) {
          hm.addSignalValueList( name, '', null, data );
        }
      }
      {
        const name = 'CODETest';
        hm.create( name, false );
        const cRedGreenBlue = [ [255,0,0], [0,255,0], [0,0,255] ];
        hm.setValueMap( name, hm.getColorMap( [-1,1], cRedGreenBlue ) );
        hm.addSignalList( name, [ '1', '2', '3', '4', '5' ] );
        for( let t = 0; t < 100; ++t ) {
          const data = [ 
            Math.cos( t*0.1 ), 
            Math.sin( t*0.02 ),
            Math.cos( t*0.2 ),
            Math.sin( t*0.05 ),
            Math.cos( t*0.5 ),
          ];
          hm.addSignalValueList( name, '', null, data );
        }
      }
      {
        const name = 'CODETest';
        hm.create( name, false );
        const cWhiteYellowRedBlack = [ [255,255,255], [223,255,0], [255,0,0], [0,0,0] ];
        hm.setValueMap( name, hm.getColorMap( [-1,1], cWhiteYellowRedBlack ) );
        hm.addSignalList( name, [ '1', '2', '3', '4', '5' ] );
        for( let t = 0; t < 100; ++t ) {
          const data = [ 
            Math.cos( t*0.1 ), 
            Math.sin( t*0.02 ),
            Math.cos( t*0.2 ),
            Math.sin( t*0.05 ),
            Math.cos( t*0.5 ),
          ];
          hm.addSignalValueList( name, t, null, data );
        }
      }
      {
        const name = 'CODETest1';
        hm.create( name );
        hm.setProperty( name, 'MaxTimestepCount', 30 );
        const cWhiteYellowRedBlack = [ [255,255,255], [223,255,0], [255,0,0], [0,0,0] ];
        hm.setValueMap( name, hm.getColorMap( [-1,1], cWhiteYellowRedBlack ) );
        hm.addSignalList( name, [ '1', '2', '3', '4', '5' ] );
        let t = 0;
        const dataStream = ()=> {
          if( t < 100 ) {
            const data = [ 
              Math.cos( t*0.1 ), 
              Math.sin( t*0.02 ),
              Math.cos( t*0.2 ),
              Math.sin( t*0.05 ),
              Math.cos( t*0.5 ),
            ];
            const tip = [
              new String( data[0] ).substring( 0, 4 )+' ['+t+']',
              new String( data[1] ).substring( 0, 4 )+' ['+t+']',
              new String( data[2] ).substring( 0, 4 )+' ['+t+']',
              new String( data[3] ).substring( 0, 4 )+' ['+t+']',
              new String( data[4] ).substring( 0, 4 )+' ['+t+']',
            ];
            hm.addSignalValueList( name, t++, null, data, tip );
            setTimeout( dataStream, 200 );
          }
        };
        dataStream();
      }
      {
        const name = 'SpeedTest';
        hm.create( name );
        const cWhiteYellowRedBlack = [ [255,255,255], [223,255,0], [255,0,0], [0,0,0] ];
        hm.setValueMap( name, hm.getColorMap( [-1,1], cWhiteYellowRedBlack ) );
        hm.addSignalList( name, [ '1', '2', '3', '4', '5' ] );
        let data = [];
        let dataLen = 10;
        for( let t = 0; t < dataLen; ++t ) {
          data.push([ 
            Math.cos( t*0.1 ), 
            Math.sin( t*0.02 ),
            Math.cos( t*0.2 ),
            Math.sin( t*0.05 ),
            Math.cos( t*0.5 ),
          ]);
        }
        console.log( 'Start speed test' );
        console.time( 'Drawing Time' );
        for( let t = 0; t < 100; ++t ) {
          const ddata = data[t % dataLen];
          hm.addSignalValueList( name, t, null, ddata );
        }
        console.timeEnd( 'Drawing Time' );
        console.log( 'End speed test' );
      }
      
    </script>
  </body>
</html>